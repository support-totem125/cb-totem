# ==============================================
# CONFIGURACIN GENERAL - IMPORTANTE EDITAR ESTO
# ==============================================
PROJECT_NAME=chatbot
TZ=America/Lima

# CONFIGURACIN DE RED Y DOMINIO - 隆EDITAR SEGN TU SERVIDOR!
# Para localhost:
#   DOMAIN_HOST=localhost
#   SERVER_IP_ADDR=127.0.0.1
# Para red interna (IP):
#   DOMAIN_HOST=192.168.1.74
#   SERVER_IP_ADDR=192.168.1.74
# Para producci贸n (dominio):
#   DOMAIN_HOST=chatbot.tudominio.com
#   SERVER_IP_ADDR=<IP_DEL_SERVIDOR>

DOMAIN_HOST=localhost
SERVER_IP_ADDR=127.0.0.1

# ==============================================
# POSTGRESQL - Base de datos compartida
# ==============================================
POSTGRES_USER=postgres
# 锔  IMPORTANTE: Generar con: openssl rand -hex 16
POSTGRES_PASSWORD=CHANGE_ME_POSTGRES_PASSWORD
POSTGRES_MULTIPLE_DATABASES=evolution,chatwoot,n8n
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# ==============================================
# REDIS - Cache compartido
# ==============================================
# 锔  IMPORTANTE: Generar con: openssl rand -hex 16
REDIS_PASSWORD=CHANGE_ME_REDIS_PASSWORD

# ==============================================
# EVOLUTION API v2 - WhatsApp API
# ==============================================

# Servidor
EVOLUTION_SERVER_TYPE=http
EVOLUTION_SERVER_PORT=8080
EVOLUTION_SERVER_URL=http://evolution-api:8080
EVOLUTION_CORS_ORIGIN=*
EVOLUTION_CORS_METHODS=GET,POST,PUT,DELETE
EVOLUTION_CORS_CREDENTIALS=true
SERVER_PORT=8080
AUTHENTICATION_EXPOSE_IN_FETCH_INSTANCES=true

# Autenticaci贸n
# 锔  IMPORTANTE: Generar con: openssl rand -hex 16 | tr '[:lower:]' '[:upper:]'
EVOLUTION_API_KEY=CHANGE_ME_EVOLUTION_API_KEY

# Logging
EVOLUTION_LOG_LEVEL=ERROR,WARN,INFO,LOG
EVOLUTION_LOG_COLOR=true
EVOLUTION_LOG_BAILEYS=error

# Configuraci贸n general
EVOLUTION_EVENT_EMITTER_MAX_LISTENERS=50
EVOLUTION_DEL_INSTANCE=false
EVOLUTION_LANGUAGE=es

# Base de datos
DATABASE_ENABLED=true
DATABASE_PROVIDER=postgresql
DATABASE_SAVE_DATA_INSTANCE=true
DATABASE_SAVE_DATA_NEW_MESSAGE=true
DATABASE_SAVE_MESSAGE_UPDATE=true
DATABASE_SAVE_DATA_CONTACTS=true
DATABASE_SAVE_DATA_CHATS=true
DATABASE_SAVE_DATA_LABELS=true
DATABASE_SAVE_DATA_HISTORIC=true
DATABASE_SAVE_IS_ON_WHATSAPP=true
DATABASE_SAVE_IS_ON_WHATSAPP_DAYS=7
DATABASE_DELETE_MESSAGE=true

# Redis Cache
CACHE_REDIS_ENABLED=true
CACHE_REDIS_TTL=604800
CACHE_REDIS_PREFIX_KEY=evolution
CACHE_REDIS_SAVE_INSTANCES=false
CACHE_LOCAL_ENABLED=false

# Webhooks
EVOLUTION_WEBHOOK_GLOBAL_ENABLED=false
EVOLUTION_WEBHOOK_GLOBAL_URL=
EVOLUTION_WEBHOOK_BY_EVENTS=false
WEBHOOK_EVENTS_APPLICATION_STARTUP=false
EVOLUTION_WEBHOOK_EVENTS_QRCODE_UPDATED=true
WEBHOOK_EVENTS_MESSAGES_SET=true
EVOLUTION_WEBHOOK_EVENTS_MESSAGES_UPSERT=true
WEBHOOK_EVENTS_MESSAGES_EDITED=true
EVOLUTION_WEBHOOK_EVENTS_MESSAGES_UPDATE=true
WEBHOOK_EVENTS_MESSAGES_DELETE=true
WEBHOOK_EVENTS_SEND_MESSAGE=true
WEBHOOK_EVENTS_CONTACTS_SET=true
WEBHOOK_EVENTS_CONTACTS_UPSERT=true
WEBHOOK_EVENTS_CONTACTS_UPDATE=true
WEBHOOK_EVENTS_PRESENCE_UPDATE=true
WEBHOOK_EVENTS_CHATS_SET=true
WEBHOOK_EVENTS_CHATS_UPSERT=true
WEBHOOK_EVENTS_CHATS_UPDATE=true
WEBHOOK_EVENTS_CHATS_DELETE=true
WEBHOOK_EVENTS_GROUPS_UPSERT=true
WEBHOOK_EVENTS_GROUPS_UPDATE=true
WEBHOOK_EVENTS_GROUP_PARTICIPANTS_UPDATE=true
EVOLUTION_WEBHOOK_EVENTS_CONNECTION_UPDATE=true
WEBHOOK_EVENTS_LABELS_EDIT=true
WEBHOOK_EVENTS_LABELS_ASSOCIATION=true
EVOLUTION_WEBHOOK_EVENTS_CALL=true
WEBHOOK_EVENTS_TYPEBOT_START=false
WEBHOOK_EVENTS_TYPEBOT_CHANGE_STATUS=false
WEBHOOK_EVENTS_ERRORS=false

# QR Code
EVOLUTION_QRCODE_LIMIT=30
EVOLUTION_QRCODE_COLOR=#175197

# Configuraci贸n de sesi贸n
EVOLUTION_CONFIG_SESSION_PHONE_CLIENT="Evolution API"
EVOLUTION_CONFIG_SESSION_PHONE_NAME=Chrome
EVOLUTION_CONFIG_SESSION_PHONE_VERSION=2.3000.1028355510

# Integraciones
TYPEBOT_ENABLED=false
TYPEBOT_API_VERSION=latest
CHATWOOT_ENABLED=true
CHATWOOT_MESSAGE_READ=true
CHATWOOT_MESSAGE_DELETE=true
CHATWOOT_BOT_CONTACT=true
CHATWOOT_IMPORT_PLACEHOLDER_MEDIA_MESSAGE=true
OPENAI_ENABLED=false
DIFY_ENABLED=false

# RabbitMQ (opcional)
RABBITMQ_ENABLED=false
RABBITMQ_URI=amqp://localhost
RABBITMQ_EXCHANGE_NAME=evolution
RABBITMQ_GLOBAL_ENABLED=false

# WebSocket
EVOLUTION_WEBSOCKET_ENABLED=false
EVOLUTION_WEBSOCKET_GLOBAL_EVENTS=false

# Pusher
PUSHER_ENABLED=false
PUSHER_GLOBAL_ENABLED=false

# Amazon SQS
SQS_ENABLED=false

# S3 Storage
S3_ENABLED=false
S3_BUCKET=evolution
S3_PORT=443
S3_USE_SSL=true

# WhatsApp Business API
WA_BUSINESS_TOKEN_WEBHOOK=evolution
WA_BUSINESS_URL=https://graph.facebook.com
WA_BUSINESS_VERSION=v20.0
WA_BUSINESS_LANGUAGE=es_MX

# Proxy (opcional)
PROXY_HOST=
PROXY_PORT=
PROXY_PROTOCOL=
PROXY_USERNAME=
PROXY_PASSWORD=

# Sentry (opcional)
SENTRY_DSN=

# ==============================================
# CHATWOOT - Plataforma de atenci贸n al cliente
# ==============================================

# Secret Key Base (debe ser una cadena hexadecimal larga y segura)
# 锔  IMPORTANTE: Generar con: openssl rand -hex 64
CHATWOOT_SECRET_KEY_BASE=CHANGE_ME_CHATWOOT_SECRET_KEY_BASE

# Rails Environment
RAILS_ENV=production

# URL del frontend (Usa DOMAIN_HOST de arriba)
CHATWOOT_FRONTEND_URL=http://${DOMAIN_HOST:-localhost}:3000

# Database
POSTGRES_DATABASE_CHATWOOT=chatwoot

# Storage
ACTIVE_STORAGE_SERVICE=local

# ActionCable (WebSocket para actualizaciones en tiempo real)
ACTION_CABLE_ALLOWED_REQUEST_ORIGINS=${DOMAIN_HOST:-localhost},127.0.0.1,${SERVER_IP_ADDR:-127.0.0.1}

# Email (SMTP) - Configura con tu proveedor de email
SMTP_ADDRESS=smtp.gmail.com
SMTP_PORT=587
SMTP_DOMAIN=gmail.com
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_AUTHENTICATION=plain
SMTP_ENABLE_STARTTLS_AUTO=true
MAILER_SENDER_EMAIL=noreply@chatwoot.com

# Configuraci贸n general
ENABLE_ACCOUNT_SIGNUP=true
FORCE_SSL=false
INSTALLATION_NAME=Chatwoot

# ==============================================
# N8N - Automatizaci贸n de workflows
# ==============================================

# Host Configuration (Usa DOMAIN_HOST de arriba)
N8N_HOST=${DOMAIN_HOST:-localhost}
N8N_PORT=5678
N8N_PROTOCOL=http
N8N_WEBHOOK_URL=http://localhost:5678/
N8N_SECURE_COOKIE=false

# Autenticaci贸n b谩sica
N8N_BASIC_AUTH_ACTIVE=true
N8N_BASIC_AUTH_USER=admin
# 锔  IMPORTANTE: Cambiar por una contrase帽a segura
N8N_BASIC_AUTH_PASSWORD=CHANGE_ME_N8N_BASIC_AUTH_PASSWORD

# Encryption Key (IMPORTANTE: Genera una clave segura)
# 锔  IMPORTANTE: Generar con: openssl rand -hex 32
N8N_ENCRYPTION_KEY=CHANGE_ME_N8N_ENCRYPTION_KEY

# Database
DB_TYPE=postgresdb
DB_POSTGRESDB_DATABASE=n8n

# Execution
EXECUTIONS_MODE=regular
EXECUTIONS_DATA_SAVE_ON_ERROR=all
EXECUTIONS_DATA_SAVE_ON_SUCCESS=all
EXECUTIONS_DATA_SAVE_MANUAL_EXECUTIONS=true

# Settings
N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS=true
N8N_RUNNERS_ENABLED=true

# ==============================================
# VARIABLES DE SERVICIOS INTERNOS (para N8N workflows)
# ==============================================
# Estas variables pueden ser usadas en los nodos de N8N
# Sintaxis en N8N: {{$env.NOMBRE_VARIABLE}}
#
# NOTA: Los nombres de contenedores funcionan dentro de Docker
# No cambiar estos valores a menos que cambies los nombres en docker-compose.yaml

# SRV-IMG-TOTEM - Servidor de cat谩logos de im谩genes
SRV_IMG_HOST=http://srv-img:8000
SRV_IMG_PORT=8000

# VCC-TOTEM - API de datos
VCC_TOTEM_HOST=http://calidda-api:5000
VCC_TOTEM_PORT=5000

# CHATWOOT - Plataforma de atenci贸n
CHATWOOT_INTERNAL_HOST=http://chatwoot-web:3000
CHATWOOT_INTERNAL_PORT=3000

# EVOLUTION API - WhatsApp
EVOLUTION_INTERNAL_HOST=http://evolution-api:8080
EVOLUTION_INTERNAL_PORT=8080

# ==============================================
# INSTRUCCIONES RPIDAS DE CONFIGURACIN
# ==============================================
#
# 1. EDITAR DOMAIN_HOST Y SERVER_IP_ADDR arriba seg煤n tu servidor:
#
#    Para localhost (desarrollo local):
#      DOMAIN_HOST=localhost
#      SERVER_IP_ADDR=127.0.0.1
#
#    Para red interna (IP privada):
#      DOMAIN_HOST=192.168.1.74
#      SERVER_IP_ADDR=192.168.1.74
#
#    Para producci贸n (dominio):
#      DOMAIN_HOST=chatbot.tudominio.com
#      SERVER_IP_ADDR=<IP_DEL_SERVIDOR>
#
# 2. GENERAR CONTRASEAS SEGURAS (ejecutar en terminal):
#    - openssl rand -hex 16       (para POSTGRES_PASSWORD, REDIS_PASSWORD)
#    - openssl rand -hex 16 | tr '[:lower:]' '[:upper:]'  (para EVOLUTION_API_KEY)
#    - openssl rand -hex 64       (para CHATWOOT_SECRET_KEY_BASE)
#    - openssl rand -hex 32       (para N8N_ENCRYPTION_KEY)
#    - openssl rand -hex 32       (para N8N_BASIC_AUTH_PASSWORD)
#
# 3. COPIAR ESTE ARCHIVO A .env Y EDITAR CON TUS VALORES:
#    cp .env.example .env
#    nano .env              # O tu editor favorito
#
# 4. INICIAR LOS SERVICIOS:
#    docker-compose up -d
#
# 5. VERIFICAR ESTADO DE SERVICIOS:
#    docker-compose ps
#    docker-compose logs -f        # Ver logs en tiempo real
#
# 6. CONFIGURAR N8N WORKFLOWS:
#    - URL: http://localhost:5678 (desde navegador)
#    - Usuario: admin (defecto)
#    - Contrase帽a: La que estableciste en N8N_BASIC_AUTH_PASSWORD
#    - En tus nodos HTTP, usa: {{$env.SRV_IMG_HOST}}, {{$env.VCC_TOTEM_HOST}}, etc.
#
# 锔  SEGURIDAD EN PRODUCCIN:
# - Cambiar todos los valores CHANGE_ME_* por valores seguros y 煤nicos
# - Cambiar FORCE_SSL=true y N8N_PROTOCOL=https
# - Configurar certificados SSL/TLS v谩lidos
# - Configurar SMTP para emails en Chatwoot
# - Hacer backup de este archivo .env
# - NUNCA compartir o commitear el archivo .env a git
# - Usar git .gitignore para excluir .env
#
#  MANTN ESTOS SECRETOS SEGUROS:
# - POSTGRES_PASSWORD
# - REDIS_PASSWORD
# - EVOLUTION_API_KEY
# - CHATWOOT_SECRET_KEY_BASE
# - N8N_ENCRYPTION_KEY
# - N8N_BASIC_AUTH_PASSWORD
#
